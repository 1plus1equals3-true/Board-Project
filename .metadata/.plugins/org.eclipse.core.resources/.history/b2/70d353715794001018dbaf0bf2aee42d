<%@page import="java.util.Enumeration"%>
<%@page import="com.oreilly.servlet.multipart.DefaultFileRenamePolicy"%>
<%@page import="com.oreilly.servlet.MultipartRequest"%>
<%@page import="java.io.File"%>
<%@ page import="java.util.Date" %>
<%@ page import="java.text.SimpleDateFormat" %>
<%@ page import="java.io.IOException"%>
<%@ page import="java.nio.file.*"%>
<%@ page language="java" contentType="application/json; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="java.sql.*" %>
<%@ page import="lib.DB" %>
<%
request.setCharacterEncoding("utf-8");

String sql = null;
Connection conn=null;
PreparedStatement ps = null;
ResultSet rs = null;

String idx = request.getParameter("idx");
String cidx = request.getParameter("cidx");
String commentmodify = request.getParameter("commentmodify");

boolean isSuccess = false;
String message = "";

try{
	 
	conn = DB.getConnection();

	sql = "update comment set ment=? where idx=?";
	ps = conn.prepareStatement(sql);
	ps.setString(1, commentmodify);
	ps.setString(2, cidx);
	ps.executeUpdate();
	
	isSuccess = true; // DB 업데이트 성공 가정
    message = "수정 완료";

}
catch(Exception e){ 
	 e.printStackTrace();
     isSuccess = false;
     message = "DB 처리 중 오류가 발생했습니다.";
}
finally {
	  	if (rs != null){
		   rs.close();
		}
		if (ps != null){
		   ps.close();
		}
		if (conn != null){
		   conn.close();
		}
}

String jsonResponse = "{ \"success\": " + isSuccess + ", \"cidx\": \"" + cidx + "\", \"message\": \"" + message + "\" }";
out.print(jsonResponse);
out.flush();
%>